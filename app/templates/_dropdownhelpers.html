{% macro render_directory(directory, hidden, collection_name) %}
    {% for file in directory recursive %}{% if file['directory'] %}<li{% if hidden and not file['checked'] %}style="display:none;"{% endif %} ><input type="checkbox" id="{{ file['collection_id'] }}~{{ file['base_path'] }}~{{ file['name'] }}" {% if file['checked'] == 1 %} checked="checked" {% endif %}{% if file['disabled'] %} disabled {% endif %}/><label class="{{file['file_class']}}" oncontextmenu="return spawn_dropdown_on(this, '{{ file['name'] }}', '{{ file['base_path'] }}', {{ file['collection_id'] }}, 'directory');" for="{{ file['collection_id'] }}~{{ file['base_path'] }}~{{ file['name'] }}" >{% if not file['disabled'] %} <div class="dropdown" style="display:inline;"><a class="dropdown-toggle" id="dd" data-toggle="dropdown" href="javascript:void(0);" title="View Menu" onclick="spawn_dropdown_on(this.parent.parent, '{{ file['name'] }}', '{{ file['base_path'] }}', {{ file['collection_id'] }}, 'directory');"><i style="display:none;" class="icon-list"></i></a></div>{% endif %} <p class="dropdown-label">{{ file['name'] }}</p></label>
                <ul>
                    {{ loop(file['files']) }}
                </ul>
            </li>{% endif %} {% if not file['directory'] %}
            <li class="{{ file['file_class'] }}" oncontextmenu="return spawn_dropdown_on(this, '{{ file['name'] }}', '{{ file['base_path'] }}', {{ file['collection_id'] }}, 'file');" for="{{ file['collection_id'] }}~{{ file['base_path'] }}~{{ file['name'] }}"><div class="dropdown" style="display:inline; font-size: 16px;"><a class="dropdown-toggle" style="font-size: 12px;" data-toggle="dropdown" href="javascript:void(0);" title="View Menu" onclick="create_dropdown(this, '{{ file['name'] }}', '{{ file['base_path'] }}', {{ file['collection_id'] }}, 'file');"><i style="display:none;" class="icon-list folder" style="margin: 0px 4px 0px 8px;"></i></a></div> <a class="dropdown-label" href="javascript:void(0);" onclick="load_file('{{ file['name'] }}', '{{ file['base_path'] }}', {{ file['collection_id'] }});" id="{{ collection_name + '/' + file['base_path'] + file['name'] }}">{{ file['name'] }}</a></li>{% endif %}{% endfor %}
{% endmacro %}
